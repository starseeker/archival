<html><head><title>CHICKEN User's Manual - Unit utils</title></head><body>
<p> </p><a name='Unit utils'><h1>Unit utils</h1></a><p>This unit contains file/pathname oriented procedures, apropos, plus acts as a "grab bag" for procedures without a good home, and which don't have to be available by default (as compared to the <a href='http://galinha.ucpel.tche.br/Unit extras' class='external'>extras</a> unit.</p><p>This unit uses the <tt>extras</tt> and <tt>regex</tt> units.</p><a name='Environment Query'><h2>Environment Query</h2></a><a name='apropos'><h3>apropos</h3></a><pre>[procedure] (apropos SYMBOL-PATTERN [ENVIRONMENT])</pre><p>Displays symbols matching <tt>SYMBOL-PATTERN</tt> in the <tt>ENVIRONMENT</tt> on the <tt>(current-output-port)</tt>.</p><dl><dt><tt>SYMBOL-PATTERN</tt></dt><dd>A symbol, string, or regex. When symbol or string substring matching is performed.</dd><dt><tt>ENVIRONMENT</tt></dt><dd>An environment. When missing the <tt>(interaction-environment)</tt> is assumed.</dd></dl><a name='apropos-list'><h3>apropos-list</h3></a><pre>[procedure] (apropos-list SYMBOL-PATTERN [ENVIRONMENT])</pre><p>Like <tt>apropos</tt> but returns a list of matching symbols.</p><a name='Pathname operations'><h2>Pathname operations</h2></a><a name='absolute-pathname?'><h3>absolute-pathname?</h3></a><pre>[procedure] (absolute-pathname? PATHNAME)</pre><p>Returns <tt>#t</tt> if the string <tt>PATHNAME</tt> names an absolute pathname, and returns <tt>#f</tt> otherwise.</p><a name='decompose-pathname'><h3>decompose-pathname</h3></a><pre>[procedure] (decompose-pathname PATHNAME)</pre><p>Returns three values: the directory-, filename- and extension-components of the file named by the string <tt>PATHNAME</tt>. For any component that is not contained in <tt>PATHNAME</tt>, <tt>#f</tt> is returned.</p><a name='make-pathname'><h3>make-pathname</h3></a><a name='make-absolute-pathname'><h3>make-absolute-pathname</h3></a><pre>[procedure] (make-pathname DIRECTORY FILENAME [EXTENSION [SEPARATOR]])
[procedure] (make-absolute-pathname DIRECTORY FILENAME [EXTENSION [SEPARATOR]])</pre><p>Returns a string that names the file with the components <tt>DIRECTORY, FILENAME</tt> and (optionally) <tt>EXTENSION</tt> with <tt>SEPARATOR</tt> being the directory separation indicator (usually <tt>/</tt> on UNIX systems and <tt>\</tt> on Windows, defaulting to whatever platform this is running on).  <tt>DIRECTORY</tt> can be <tt>#f</tt> (meaning no directory component), a string or a list of strings. <tt>FILENAME</tt> and <tt>EXTENSION</tt> should be strings or <tt>#f</tt>. <tt>make-absolute-pathname</tt> returns always an absolute pathname.</p><a name='pathname-directory'><h3>pathname-directory</h3></a><pre>[procedure] (pathname-directory PATHNAME)</pre><a name='pathname-file'><h3>pathname-file</h3></a><pre>[procedure] (pathname-file PATHNAME)</pre><a name='pathname-extension'><h3>pathname-extension</h3></a><pre>[procedure] (pathname-extension PATHNAME)</pre><p>Accessors for the components of <tt>PATHNAME</tt>. If the pathname does not contain the accessed component, then <tt>#f</tt> is returned.</p><a name='pathname-replace-directory'><h3>pathname-replace-directory</h3></a><pre>[procedure] (pathname-replace-directory PATHNAME DIRECTORY)</pre><a name='pathname-replace-file'><h3>pathname-replace-file</h3></a><pre>[procedure] (pathname-replace-file PATHNAME FILENAME)</pre><a name='pathname-replace-extension'><h3>pathname-replace-extension</h3></a><pre>[procedure] (pathname-replace-extension PATHNAME EXTENSION)</pre><p>Return a new pathname with the specified component of <tt>PATHNAME</tt> replaced by a new value.</p><a name='pathname-strip-directory'><h3>pathname-strip-directory</h3></a><pre>[procedure] (pathname-strip-directory PATHNAME)</pre><a name='pathname-strip-extension'><h3>pathname-strip-extension</h3></a><pre>[procedure] (pathname-strip-extension PATHNAME)</pre><p>Return a new pathname with the specified component of <tt>PATHNAME</tt> stripped.</p><a name='Temporary files'><h2>Temporary files</h2></a><a name='create-temporary-file'><h3>create-temporary-file</h3></a><pre>[procedure] (create-temporary-file [EXTENSION])</pre><p>Creates an empty temporary file and returns its pathname. If <tt>EXTENSION</tt> is not given, then <tt>.tmp</tt> is used. If the environment variable <tt>TMPDIR, TEMP</tt> or <tt>TMP</tt> is set, then the pathname names a file in that directory.</p><a name='Deleting a file without signalling an error'><h2>Deleting a file without signalling an error</h2></a><a name='delete-file*'><h3>delete-file*</h3></a><pre>[procedure] (delete-file* FILENAME)</pre><p>If the file <tt>FILENAME</tt> exists, it is deleted and <tt>#t</tt> is returned.  If the file does not exist, nothing happens and <tt>#f</tt> is returned.</p><a name='Iterating over input lines and files'><h2>Iterating over input lines and files</h2></a><a name='for-each-line'><h3>for-each-line</h3></a><pre>[procedure] (for-each-line PROCEDURE [PORT])</pre><p>Calls <tt>PROCEDURE</tt> for each line read from <tt>PORT</tt> (which defaults to the value of <tt>(current-input-port)</tt>. The argument passed to <tt>PORCEDURE</tt> is a string with the contents of the line, excluding any line-terminators. When all input has been read from the port, <tt>for-each-line</tt> returns some unspecified value.</p><a name='for-each-argv-line'><h3>for-each-argv-line</h3></a><pre>[procedure] (for-each-argv-line PROCEDURE)</pre><pre>Opens each file listed on the command line in order, passing one line</pre><p>at a time into <tt>PROCEDURE</tt>.  The filename <tt>-</tt> is interpreted as <tt>(current-input-port)</tt>.  If no arguments are given on the command line it again uses the value of <tt>(current-input-port)</tt>. During execution of <tt>PROCEDURE</tt>, the current input port will be correctly bound to the current input source.</p><p>This code will act as a simple Unix cat(1) command:</p><PRE>
(for-each-argv-line print)
</PRE>
<a name='port-for-each'><h3>port-for-each</h3></a><pre>[procedure] (port-for-each FN THUNK)</pre><p>Apply <tt>FN</tt> to successive results of calling the zero argument procedure <tt>THUNK</tt> until it returns <tt>#!eof</tt>, discarding the results.</p><a name='port-map'><h3>port-map</h3></a><pre>[procedure] (port-map FN THUNK)</pre><p>Apply <tt>FN</tt> to successive results of calling the zero argument procedure <tt>THUNK</tt> until it returns <tt>#!eof</tt>, returning a list of the collected results.</p><a name='Executing shell commands with formatstring and error checking'><h2>Executing shell commands with formatstring and error checking</h2></a><a name='system*'><h3>system*</h3></a><pre>[procedure] (system* FORMATSTRING ARGUMENT1 ...)</pre><p>Similar to <tt>(system (sprintf FORMATSTRING ARGUMENT1 ...))</tt>, but signals an error if the invoked program should return a nonzero exit status.</p><a name='Reading a file%27s contents'><h2>Reading a file's contents</h2></a><a name='read-all'><h3>read-all</h3></a><pre>[procedure] (read-all [FILE-OR-PORT])</pre><p>If <tt>FILE-OR-PORT</tt> is a string, then this procedure returns the contents of the file as a string. If <tt>FILE-OR-PORT</tt> is a port, all remaining input is read and returned as a string. The port is not closed. If no argument is provided, input will be read from the port that is the current value of <tt>(current-input-port)</tt>.</p><a name='Miscellaneous handy things'><h2>Miscellaneous handy things</h2></a><a name='shift!'><h3>shift!</h3></a><pre>[procedure] (shift! LIST [DEFAULT])</pre><p>Returns the car of <tt>LIST</tt> (or <tt>DEFAULT</tt> if <tt>LIST</tt> is empty) and replaces the car of <tt>LIST</tt> with it's cadr and the cdr with the cddr. If <tt>DEFAULT</tt> is not given, and the list is empty, <tt>#f</tt> is returned. An example might be clearer, here:</p><PRE>
(<B><FONT COLOR="#A020F0">define</FONT></B> <B><FONT COLOR="#0000FF">lst</FONT></B> '(1 2 3))
(shift! lst)             =<B><FONT COLOR="#A020F0">=&gt;</FONT></B> 1, lst is now (2 3)
</PRE>
<pre></pre><p>The list must at least contain 2 elements.</p><a name='unshift!'><h3>unshift!</h3></a><pre>[procedure] (unshift! X PAIR)</pre><p>Sets the car of <tt>PAIR</tt> to <tt>X</tt> and the cdr to its cddr. Returns <tt>PAIR</tt>:</p><PRE>
(<B><FONT COLOR="#A020F0">define</FONT></B> <B><FONT COLOR="#0000FF">lst</FONT></B> '(2))
(unshift! 99 lst)      <I><FONT COLOR="#B22222">; lst is now (99 2)
</FONT></I></PRE>
<p>Previous: <a href='unit-posix.html' class='internal'>Unit posix</a></p><p>Next: <a href='unit-tcp.html' class='internal'>Unit tcp</a></p>
</body></html>